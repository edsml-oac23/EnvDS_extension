<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      margin: 0;
      padding: 16px;
      color: var(--vscode-foreground);
      background-color: var(--vscode-editor-background);
    }

    h1 {
      font-size: 1.6em;
      font-weight: 600;
      margin: 0 0 16px 0;
      color: var(--vscode-titleBar-activeForeground);
    }

    /* Detail card (like ml.school “1.1 Preparing your environment” box) */
    .detail-card {
      border-radius: 8px;
      padding: 16px;
      margin-bottom: 24px;
      background: var(--vscode-sideBar-dropBackground);
      border: 1px solid var(--vscode-panel-border);
    }

    .detail-session {
      font-size: 0.9em;
      margin-bottom: 4px;
      opacity: 0.8;
    }

    .detail-title {
      font-size: 1.05em;
      font-weight: 600;
      margin-bottom: 4px;
    }

    .detail-description {
      font-size: 0.9em;
      margin-bottom: 12px;
      opacity: 0.9;
    }

    .hidden {
      display: none;
    }

    .highlight {
      background: var(--vscode-button-background);
      color: white;
      padding: 8px 14px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 500;
      display: inline-block;
    }

    .highlight:hover {
      background: var(--vscode-button-hoverBackground);
    }

    .session {
      margin-bottom: 20px;
    }

    .session-header {
      font-size: 1.1em;
      font-weight: 600;
      padding: 8px 0 4px 0;
      color: var(--vscode-foreground);
    }

    .section {
      margin: 4px 0;
    }

    .section-title {
      cursor: pointer;
      padding: 4px 0;
      font-size: 0.95em;
    }

    .section-title.active {
      font-weight: 600;
    }

    .section-subtitle {
      font-size: 0.78em;
      opacity: 0.7;
      margin-left: 2px;
    }
  </style>
</head>
<body>
  <h1>Environmental Data Science Module</h1>

  <!-- Detail card that appears when a step is clicked -->
  <div id="detail-card" class="detail-card hidden">
    <div id="detail-session" class="detail-session"></div>
    <div id="detail-title" class="detail-title"></div>
    <div id="detail-description" class="detail-description"></div>
    <button id="detail-check" class="highlight">Check dependencies</button>
  </div>

  <!-- Week / Session list (no expand/collapse, same style as ml.school) -->
  <div class="session">
    <div class="session-header">Week 1 – Climate & Time Series</div>

    <div class="section">
      <div
        class="section-title"
        data-path="week1/1.1-setup.md"
        data-session="Week 1 – Climate & Time Series"
        data-description="Setting up your development environment and installing the required dependencies."
        data-checkdeps="true"
      >
        1.1. Preparing your environment
      </div>
    </div>

    <div class="section">
      <div
        class="section-title"
        data-path="week1/1.2-climate-stac.md"
        data-session="Week 1 – Climate & Time Series"
        data-description="Accessing climate data through STAC APIs and loading cubes with Xarray."
      >
        1.2. Climate data via STAC
      </div>
    </div>

    <div class="section">
      <div
        class="section-title"
        data-path="week1/1.3-time-series-xarray.md"
        data-session="Week 1 – Climate & Time Series"
        data-description="Working with climate time series: resampling, anomalies, temporal aggregation."
      >
        1.3. Time series with Xarray
      </div>
    </div>

    <div class="section">
      <div
        class="section-title"
        data-path="week1/1.4-smart-vineyard.md"
        data-session="Week 1 – Climate & Time Series"
        data-description="Smart Vineyard mini-project combining SAM segmentation and climate signals."
      >
        1.4. Smart Vineyard project
      </div>
    </div>
  </div>

  <div class="session">
    <div class="session-header">Week 3 – Remote Sensing & GeoAI</div>

    <div class="section">
      <div
        class="section-title"
        data-path="week3/3.1-foundation-eo.md"
        data-session="Week 3 – Remote Sensing & GeoAI"
        data-description="Foundation models in Earth Observation: SAM, CLIP and vision transformers."
      >
        3.1. Foundation models in EO
      </div>
    </div>

    <div class="section">
      <div
        class="section-title"
        data-path="week3/3.2-geoai-classification.md"
        data-session="Week 3 – Remote Sensing & GeoAI"
        data-description="From classical ML to GeoAI segmentation for land-cover classification."
      >
        3.2. GeoAI classification
      </div>
    </div>

    <div class="section">
      <div
        class="section-title"
        data-path="week3/3.4-nagasaki-change.md"
        data-session="Week 3 – Remote Sensing & GeoAI"
        data-description="Nagasaki change-detection project with pre- and post-event imagery."
      >
        3.3. Nagasaki change project
      </div>
    </div>
  </div>

  <script>
    const vscode = acquireVsCodeApi();

    const detailCard = document.getElementById('detail-card');
    const detailSession = document.getElementById('detail-session');
    const detailTitle = document.getElementById('detail-title');
    const detailDescription = document.getElementById('detail-description');
    const detailCheck = document.getElementById('detail-check');

    let activeSection = null;
    let activeSectionPath = null;

    function setActiveSection(el) {
      if (activeSection) {
        activeSection.classList.remove('active');
      }
      activeSection = el;
      activeSection.classList.add('active');

      const sessionText = el.getAttribute('data-session') || '';
      const description = el.getAttribute('data-description') || '';
      const showCheck = el.getAttribute('data-checkdeps') === 'true';

      detailSession.textContent = sessionText;
      detailTitle.textContent = el.textContent.trim();
      detailDescription.textContent = description;

      detailCheck.style.display = showCheck ? 'inline-block' : 'none';
      detailCard.classList.remove('hidden');

      activeSectionPath = el.getAttribute('data-path');
    }

    // Click on a section: update card + open markdown
    document.querySelectorAll('.section-title').forEach(el => {
      el.addEventListener('click', () => {
        setActiveSection(el);
        const path = el.getAttribute('data-path');
        vscode.postMessage({
          command: 'openSection',
          path: path   // extension.ts already prefixes ".guide/"
        });
      });
    });

    // Check dependencies button inside the card
    detailCheck.addEventListener('click', () => {
      vscode.postMessage({ command: 'checkDependencies' });
    });
  </script>
</body>
</html>
